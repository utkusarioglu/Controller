!function(e,t){for(var r in t)e[r]=t[r]}(exports,function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(n,o,function(t){return e[t]}.bind(null,o));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=5)}([function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n="RI";t.C_Controller={AllServices:"App",GraceTime:20,E_AlreadyDefined:"Controller already defined",E_CalledBeforeDeclaration:"Controller called before declaration",E_NoScopeSelected:["There is a problem with the scopes. ","It may be due to undefiend LocalNamespace ","if the code is expected to work in local scope"].join(""),E_MultipleRequestsBeforeResponse:"Multiple requests for the content was placed before the promise was resolved",E_ForcedDynamic:"All services are forced to be dynamic",E_ActiveStepMemberCount:"Active step requires %0 members"},t.C_BootState={ClassReady:[n,"class_ready"],ListenReady:[n,"listen_ready"],TalkReady:[n,"talk_ready"],ModulesReady:[n,"modules_ready"],DependencyReady:[n,"dependency_ready"],ServerReady:[n,"server_ready"],TestReady:[n,"test_ready"],ModuleInstalled:[n,"module_installed"],LibraryAdded:[n,"LibraryAdded"]},t.C_StartupTalk={run_Listen:[n,"run_listen"],run_Talk:[n,"run_talk"],run_Requests:[n,"run_requests"],run_Modules:[n,"run_modules"],run_Server:[n,"run_server"],run_Tests:[n,"run_tests"],send_Archive:[n,"send_Archive"],add_Archive:[n,"add_Archive()"]}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.Local=1]="Local",e[e.Global=10]="Global",e[e.LocalAndGlobal=11]="LocalAndGlobal"}(t.e_Scope||(t.e_Scope={})),function(e){e[e.Standard=0]="Standard"}(t.e_ServiceGroup||(t.e_ServiceGroup={}))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(3),o=r(6),i=r(4),s=r(0),a=r(1);class c extends i.SeparatorHandler{constructor(e){return super(),this.set_GlobalNamespace(e),this}static flush_GlobalController(){c._global_controller=new o.BaseController(a.e_Scope.Global),c.flush_GlobalNamespaces()}request(e,t,r,o=a.e_ServiceGroup.Standard){const i=t+this.get_Separator("Dialogue")+o,s=n.Resolution.produce_UniqueInstructionCode(r);return c.is_StaticResponder(i)&&!c._forced_dynamic_service?c._static_content_archive.sniff([i,s],()=>{const n=this.request_DynamicTransmission(e,t,r,o);return c.set_PromisifiedStaticContent(i,s,n),n},e=>(console.warn("Serving static content"),e.Time=(new Date).getTime(),Promise.resolve(e))):this.request_DynamicTransmission(e,t,r,o)}request_DynamicTransmission(e,t,r,n=a.e_ServiceGroup.Standard){return this.get_Scopes(e)[0].request(e,this._controller_global_namespace,t,r,n)}respond(e,t,r=!0,n=a.e_ServiceGroup.Standard){r&&c._static_responders.push(this._controller_global_namespace+this.get_Separator("Dialogue")+n),this.get_Scopes(e).forEach(r=>{r.respond(this._controller_global_namespace,t,n,e)})}get_DialogueArchive(e){return this.get_Scopes(e)[0].get_DialogueArchive()}static set_PromisifiedStaticContent(e,t,r){r.then(r=>{c._static_content_archive.pave([e,t],()=>{console.warn(s.C_Controller.E_MultipleRequestsBeforeResponse)},()=>(r.LastDynamicTime=r.Time,r.Time=0,r.Static=!0,r))})}static get_AllStaticChannels(){return c._static_responders}static get_AllStaticContent(){return c._static_content_archive}static flush_StaticContentArchive(){c._static_content_archive={}}static force_AllDynamicService(){console.log(s.C_Controller.E_ForcedDynamic),c._forced_dynamic_service=!0}announce(e,t,r,n=!1){this.get_Scopes(e).forEach(o=>{o.announce(e,this._controller_global_namespace,t,r,n)})}static is_StaticResponder(e){return-1!==this._static_responders.indexOf(e)}get_AnnouncementArchive(e){return this.get_Scopes(e)[0].get_AnnouncementArchive()}subscribe(e,t,r,n){this.get_Scopes(e).forEach(o=>{o.subscribe(e,t,r,n)})}wait(e,t,r,n=(()=>!0),o=(()=>{}),i=1,s=i){return this.get_Scopes(e)[0].wait(e,this._controller_global_namespace,t,r,n,o,i,s)}wait_Some(e,t){return this.get_Scopes(e)[0].wait_Some(e,this._controller_global_namespace,t)}set_LocalNamespace(e){return this._controller_local_namespace=e,this.create_LocalNamespace(e),this}get_LocalNamespace(){return this._controller_local_namespace}get_LocalNamespaces(){return Object.keys(c._local_controllers)}set_GlobalNamespace(e){return this._controller_global_namespace=e,this.add_Controller_ToGlobalNamespaces(e),this}get_GlobalNamespace(){return this._controller_global_namespace}create_LocalNamespace(e){c._local_controllers.pave([e],()=>{},()=>new o.BaseController(a.e_Scope.Local))}destroy_LocalNamespace(e){delete c._local_controllers[e]}add_Controller_ToGlobalNamespaces(e){c._global_namespaces.push(e)}get_GlobalNamespaces(){return c._global_namespaces}static flush_GlobalNamespaces(){c._global_namespaces=[]}get_Scopes(e){const t=[];if(1&e&&this._controller_local_namespace&&t.push(c._local_controllers[this._controller_local_namespace]),2&e&&t.push(c._global_controller),t.length<1)throw new Error(s.C_Controller.E_NoScopeSelected);return t}static get_LocalControllerStack(){return c._local_controllers}}t.Controller=c,c._global_controller=new o.BaseController(a.e_Scope.Global),c._local_controllers={},c._global_namespaces=[],c._static_content_archive={},c._static_responders=[],c._forced_dynamic_service=!1},function(e,t){!function(e,t){for(var r in t)e[r]=t[r]}(t,function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(n,o,function(t){return e[t]}.bind(null,o));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=6)}([function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(1),o=r(2),i=r(3),s=r(4),a=r(5);class c extends(n.Parent().with(o.M_Namespace,i.M_State)){constructor(e,t="RI"){return super(),this.set_GlobalNamespace("App/Common/Resolver/Resolution"),this.initialize_State(),this.set_Key(t),this.set_ResolutionInstruction(e),this}set_Key(e){return this.get_State().set_Var("Key",e),this}get_Key(){return this.get_State().get_Var("Key")}set_ResolutionInstruction(e){if(!c.is_ResolutionInstruction(e,this.get_Key())){const t=JSON.stringify(e);throw new Error(s.C_Resolver.E_IllegalRi.subs(t))}this.get_State().set_Var("ResolutionInstruction",e);const t=c.extract_ExpressionTrail(e);this.set_ExpressionTrail(t);const r=c.extract_ArgumentPool(e);return this.set_ArgumentPool(r),this}get_ResolutionInstruction(){return this.get_State().get_Var("ResolutionInstruction")}static is_ResolutionInstruction(e,t="RI"){return e[0]===t&&e.length>1}static produce_UniqueInstructionCode(e){return JSON.stringify(e)}set_ExpressionTrail(e){if(""===e)throw new Error(s.C_Resolver.E_ETEmpty);return this.get_State().set_Var("ExpressionTrail",e),this.produce_set_ExpressionStack_FromExpressionTrail(e),this}get_ExpressionTrail(){return this.get_State().get_Var("ExpressionTrail")}produce_set_ExpressionTrail_FromStack(e){const t=c.produce_ExpressionTrail_FromStack(e);this.set_ExpressionTrail(t)}static produce_ExpressionTrail_FromStack(e){return e.join(s.C_Resolver.EXPRESSION_SEPARATOR)}static extract_ExpressionTrail(e){return e[1]}set_ExpressionStack(e){return this.get_State().set_Var("ExpressionStack",e),this}get_ExpressionStack(){return this.get_State().get_Var("ExpressionStack")}produce_set_ExpressionStack_FromExpressionTrail(e){const t=c.produce_ExpressionStack_FromTrail(e);this.set_ExpressionStack(t)}static produce_ExpressionStack_FromTrail(e){return e.split(s.C_Resolver.EXPRESSION_SEPARATOR)}static extract_ArgumentPool(e){const t=c.produce_ResolutionDepth_FromInstruction(e);let r=[];e.length>s.C_Resolver.ARG_OFFSET&&(r=e.slice(-e.length+s.C_Resolver.ARG_OFFSET));for(let e=r.length;e<t;e++)r.push([]);return r}set_ArgumentPool(e){this.get_State().set_Var("ArgumentPool",e)}get_ArgumentPool(){return this.get_State().get_Var("ArgumentPool")}static extract_Arguments(e,t=0){return c.extract_ArgumentPool(e)[t]}static subs_Arguments(e,t,r){return e[s.C_Resolver.ARG_OFFSET+t]=r,e}static extract_Argument(e,t=0,r=0){return c.extract_Arguments(e,t)[r]}static subs_ArgumentValue(e,t="args",r){const n=JSON.stringify(r),o=JSON.stringify(e).replace(new RegExp(t,"g"),n);return JSON.parse(o)}produce_ExecutionStepStack(e){let t=0,r=this.get_ExpressionStack(),n=this.get_ArgumentPool();return e.hasOwnProperty("Last")&&(r=[...r,...e.Last]),e.hasOwnProperty("First")&&(t+=e.First.length,r=[...e.First,...r]),e.hasOwnProperty("During")&&r.map((o,i)=>{const s=i+t;if(e.During[s]){const t=e.During[s],o=r.splice(i,1,t);n.splice(i,0,o)}}),r.map((e,t)=>{const r=c.extract_ExpressionType(e);if(r!==a.e_expressionType.Key){const o=n[t]||[];return[r,c.extract_MethodName(e),o]}return[r,e]})}static extract_ExpressionType(e){return e.slice(0,4)===s.C_Resolver.INSTANTIATION_INDICATOR?a.e_expressionType.Instantiate:e.slice(-2)===s.C_Resolver.METHOD_INDICATOR?a.e_expressionType.Method:a.e_expressionType.Key}static extract_MethodName(e){return e.replace(s.C_Resolver.INSTANTIATION_INDICATOR,"").replace(s.C_Resolver.METHOD_INDICATOR,"")}static produce_ResolutionDepth(e){return e.get_ExpressionStack().length}static produce_ResolutionDepth_FromInstruction(e){const t=c.extract_ExpressionTrail(e);return c.produce_ExpressionStack_FromTrail(t).length}}t.Resolution=c},function(e,t){!function(e,t){for(var r in t)e[r]=t[r]}(t,function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(n,o,function(t){return e[t]}.bind(null,o));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=0)}([function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1);t.Parent=n.Parent},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Parent=e=>new n(e);class n{constructor(e){this.extender_class=e||class{}}with(...e){return e.reduce((e,t)=>n.produce_ClassExpression(t)(e),this.extender_class)}static produce_ClassExpression(e){return t=>{const r=class extends t{};return Object.getOwnPropertyNames(e.prototype).forEach(t=>{r.prototype.hasOwnProperty(t)||Object.defineProperty(r.prototype,t,Object.getOwnPropertyDescriptor(e.prototype,t))}),r}}}}]))},function(e,t){!function(e,t){for(var r in t)e[r]=t[r]}(t,function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(n,o,function(t){return e[t]}.bind(null,o));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=0)}([function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1);t.M_Namespace=n.M_Namespace},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(2);t.M_Namespace=class{get_GlobalNamespace(){if(!this._global_namespace)throw new Error(n.C_Namespace.E_CalledBeforeDeclaration);return this._global_namespace}get_GlobalNamespaceStack(){const e=this.get_GlobalNamespace();return this.produce_Stack(e)}set_GlobalNamespace(e){if(void 0!==this._global_namespace)throw new Error(n.C_Namespace.E_AlreadyDefined);return this.check_NamespaceInput(e),this._global_namespace=e,this}get_LocalNamespace(){if(!this._local_namespace)throw new Error(n.C_Namespace.E_CalledBeforeDeclaration);return this._local_namespace}get_LocalNamespaceStack(){const e=this.get_LocalNamespace();return this.produce_Stack(e)}set_LocalNamespace(e){if(this._local_namespace)throw new Error(n.C_Namespace.E_AlreadyDefined);this.check_NamespaceInput(e),this._local_namespace=e}has_LocalNamespace(){return void 0!==this._local_namespace&&null!==this._local_namespace}check_NamespaceInput(e){if(void 0===e||0===e.length)throw new Error(n.C_Namespace.E_NoEmpty)}produce_Stack(e){return e.split(n.C_Namespace.NamespaceSeparator)}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.C_Namespace={E_AlreadyDefined:"%1 Namespace already defined",E_CalledBeforeDeclaration:"%1 Namespace called before declaration",E_NoEmpty:"%1 Namespace declaration cannot be empty",NamespaceSeparator:"/"}}]))},function(e,t){!function(e,t){for(var r in t)e[r]=t[r]}(t,function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(n,o,function(t){return e[t]}.bind(null,o));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=2)}([function(e,t,r){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),r(5),r(6);const n=r(1),o=r(7);class i{constructor(e="Generic",t=null){this._channel=e,this._id=t||Math.random().toString().slice(2),i._states.pave([this._channel,this._id],()=>{this.throw_OverloadError()},()=>({}))}get_Var(e){return i._states.sniff([this._channel,this._id],()=>{console.log(n.C_State.E_VarNotDefined.subs(this._channel,this._id))},t=>t.sniff(e,()=>{},e=>e))}set_Var(e,t){return i._states[this._channel][this._id].pave(e,()=>t,()=>t),this}copy_Var(e){const t=this.get_Var(e);return t?JSON.parse(JSON.stringify(t)):void 0}has_Var(e){return i._states[this._channel][this._id].sniff(e,()=>!1,()=>!0)}set_Vars(e){return Object.entries(e).forEach(([e,t])=>{this.set_Var(e,t)}),this}get_Vars(){return i._states[this._channel][this._id]}static get_AllStates(e=!0){if(e){let e={};return Object.entries(this._states).forEach(([t,r])=>{const n=Object.keys(r);n.length<2?e[t]=r[n[0]]:e[t]=r}),e}return i._states}get_Id(){return this._id}get_Channel(){return this._channel}set_Separators_FromGlobal(){e.hasOwnProperty("Separator")?this.set_Separators(e.Separator):this.set_Separators({Directory:"/",Expression:".",Id:"-",Dialogue:"?",Monologue:":",Namespace:"/",Extension:"."})}set_Separators(e){i.SEPARATOR=e}remove_State(){delete i._states[this._channel][this._id],i._states[this._channel].is_empty()&&delete i._states[this._channel]}static remove_AllStates(){i._states={}}track_Variable(e,t,r=(()=>!0)){if(!i._tracking_enabled)return;const n=this.get_Channel(),o={Time:(new Date).getTime(),Channel:n,Namespace:n.split(":")[0].split("?")[0],Id:this.get_Id(),Variable:e,Value:void 0===t?this.copy_Var(e):t};r(o)&&i._track_stack.push(o)}static track_Variable(e,t,r){if(!i._tracking_enabled)return;const n={Time:(new Date).getTime(),Channel:e,Namespace:e.split(":")[0].split("?")[0],Id:"-",Variable:t,Value:r};i._track_stack.push(n)}static get_AllTrackRecords(){return i._tracking_enabled?i._track_stack:n.C_State.E_TrackingOff}static get_AllTrackedChannels(){return i._tracking_enabled?i._track_stack.map(e=>e.Channel).filter((e,t,r)=>r.indexOf(e)===t):n.C_State.E_TrackingOff}static get_AllTrackedNamespaces(){return i._tracking_enabled?i._track_stack.map(e=>e.Namespace).filter((e,t,r)=>r.indexOf(e)===t):n.C_State.E_TrackingOff}static get_SomeTrackRecords(e,t=!0,r=o.e_filterMode.And){if(!i._tracking_enabled)return n.C_State.E_TrackingOff;let s=i._track_stack.filter(t=>{const n=e.sniff("Time",()=>!0,([e,r])=>(void 0===e||t.Time>=e)&&(void 0===r||t.Time<=r)),i=e.sniff("Channels",()=>!0,e=>void 0!==e.find(e=>t.Channel===e)||0===e.length),s=e.sniff("Namespaces",()=>!0,e=>void 0!==e.find(e=>t.Namespace===e)||0===e.length);return[n,i,e.sniff("Variables",()=>!0,e=>void 0!==e.find(e=>t.Variable===e)||0===e.length),e.sniff("Call",()=>!0,e=>e(t)),s].reduce((e,t)=>{switch(e=void 0===e||e,r){case o.e_filterMode.And:return e&&t;case o.e_filterMode.Or:return e||t}})});return t&&(s=s.map(e=>(delete e.Channel,delete e.Time,delete e.Id,e))),s}set_OptionalProperties(e,t){return e.forEach(e=>{this.assign_Property(e,t)}),this}set_RequiredProperties(e,t){return e.forEach(e=>{if(!this.assign_Property(e,t))throw new Error(n.C_State.E_PropertyRequired.subs(e))}),this}assign_Property(e,t){let r=e.split(i.SEPARATOR.Expression).slice(-1)[0];return t.sniff(r,()=>!1,()=>(this.set_Var(e,t[r]),!0))}set_OptionalClasses(e,t){return Object.keys(e).forEach(r=>{this.assign_Class(e,r,t)}),this}set_RequiredClasses(e,t){return Object.keys(e).forEach(r=>{if(!this.assign_Class(e,r,t))throw new Error(n.C_State.E_PropertyRequired.subs(r))}),this}throw_OverloadError(e=["empty"]){throw new Error(n.C_State.E_ChOverload.subs(this._channel,this._id,JSON.stringify(e)))}assign_Class(e,t,r){let n=t.split(i.SEPARATOR.Expression),o=n.slice(-1)[0];if(r.hasOwnProperty(o)){const i=Array.isArray(r[o])?r[o]:[r[o]];return this.get_Vars().pave(n,()=>{this.throw_OverloadError(n)},()=>i.map(r=>new e[t](r))),!0}return!1}}t.State=i,i._states={},i._track_stack=[],i._tracking_enabled=!0}).call(this,r(4))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.C_State={E_VarNotDefined:"Instance %0/%1 is not defined",E_TrackingOff:"Tracking Disabled",E_PropertyRequired:"Property '%0' is required",E_ChOverload:"Channel overload occured at: %0.%1\n%2",E_AlreadyDefined:"State already defined",E_CalledBeforeDeclaration:"State called before declaration"}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(3);t.M_State=n.M_State;var o=r(0);t.State=o.State},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(0),o=r(1);t.M_State=class{initialize_State(e){if(void 0!==this._state)throw new Error(o.C_State.E_AlreadyDefined);const t=this.get_GlobalNamespace();return this._state=new n.State(t),void 0!==e&&this._state.set_Vars(e),this}get_State(){if(!(this._state instanceof n.State))throw new Error(o.C_State.E_CalledBeforeDeclaration);return this._state}remove_State(){this._state.remove_State()}}},function(e,t){var r;r=function(){return this}();try{r=r||new Function("return this")()}catch(e){"object"==typeof window&&(r=window)}e.exports=r},function(e,t){!function(e,t){for(var r in t)e[r]=t[r]}(t,function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(n,o,function(t){return e[t]}.bind(null,o));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=0)}([function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1);Object.prototype.sniff=function(e,t,r){void 0===t&&(t=function(){return!1}),void 0===r&&(r=function(){return!0});for(var o=this,i=0,s=Array.isArray(e)?e:e.split(n.Separator.Expression);i<s.length;i++){var a=s[i];if(void 0===o[a])return t(o);o=o[a]}return r(o)},Object.prototype.pave=function(e,t,r){void 0===t&&(t=function(){return Object}),void 0===r&&(r=function(){return Object});var o=Array.isArray(e)?e:e.split(n.Separator.Expression),i=o.pop(),s=this,a=function(e){if(void 0===e[i])return e[i]=r()||{},!0;var n=t();return n&&(e[i]=n),!1};if(!(o.length>0))return a(s);s.sniff(o,(function(){for(var e=0,t=o;e<t.length;e++){var r=t[e];s[r]=s[r]?s[r]:{},s=s[r]}return a(s)}),(function(e){return a(e)}))},Object.prototype.is_empty=function(){for(var e in this)if(this.hasOwnProperty(e))return!1;return!0},Object.prototype.is_Object=function(){return this===Object(this)},Object.prototype.has_Function=function(e){return"function"==typeof this[e]}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Separator={Expression:"."}}]))},function(e,t){!function(e,t){for(var r in t)e[r]=t[r]}(t,function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(n,o,function(t){return e[t]}.bind(null,o));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=0)}([function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),String.prototype.toProperCase=function(){return this.replace(/\w\S*/g,e=>e.charAt(0).toUpperCase()+e.substr(1).toLowerCase())},String.prototype.minify=function(){return this.replace(/\s/g,"")},String.prototype.chop=function(e=50){const t=new RegExp(`.{1,${e}}`,"g");return this.match(t)||[]},String.prototype.subs=function(...e){return e.reduce((e,t,r)=>e.replace(`%${r}`,t),this)}}]))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.And=0]="And",e[e.Or=1]="Or"}(t.e_filterMode||(t.e_filterMode={}))}]))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.C_Resolver={RulesVarName:"RESOLUTION_RULES",E_NonPotentAttempt:"Attempt to enable string that isn't a disabled passage",E_NonStringType:"Non-string type given to enable_Passage",E_DoesNotCarry:"Base does not carry expression '%0'\n",E_DepthInconsistent:"MinDepth cannot be larger than MaxDepth",E_TooDeep:"Resolution is deeper than the max allowed depth",E_TooShallow:"Resolution is shallower than the min allowed depth",E_MinTrailDepthLimit:"min trail depth cannot be smaller than 1",DISABLED_PHRASE:"<<DISABLED>>",EXPRESSION_SEPARATOR:".",DoesNotCarry:"Sources does not point to any expression named %0",E_IllegalRi:"Illegal and/or wrong key ResolutionInstruction",E_ETEmpty:"ExpressionTrail cannot be empty",E_ArgHolderNonexist:"Argument holder does not exist\nRI:%0\nExpression level: %1",INSTANTIATION_INDICATOR:"new ",METHOD_INDICATOR:"()",ARG_OFFSET:2}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.Instantiate=0]="Instantiate",e[e.Method=1]="Method",e[e.Key=2]="Key"}(t.e_expressionType||(t.e_expressionType={})),function(e){e[e.Null=0]="Null",e[e.Object=1]="Object",e[e.Array=2]="Array",e[e.Other=3]="Other",e[e.Undefined=4]="Undefined",e[e.VariableType=5]="VariableType",e[e.Resolution=6]="Resolution",e[e.ResolutionInstruction=7]="ResolutionInstruction"}(t.e_typeDefinition||(t.e_typeDefinition={}))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),r(7);var n=r(0);t.Resolution=n.Resolution;var o=r(8);t.Resolver=o.Resolver},function(e,t){!function(e,t){for(var r in t)e[r]=t[r]}(t,function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(n,o,function(t){return e[t]}.bind(null,o));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=0)}([function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1);Object.prototype.sniff=function(e,t,r){void 0===t&&(t=function(){return!1}),void 0===r&&(r=function(){return!0});for(var o=this,i=0,s=Array.isArray(e)?e:e.split(n.Separator.Expression);i<s.length;i++){var a=s[i];if(void 0===o[a])return t(o);o=o[a]}return r(o)},Object.prototype.pave=function(e,t,r){void 0===t&&(t=function(){return Object}),void 0===r&&(r=function(){return Object});var o=Array.isArray(e)?e:e.split(n.Separator.Expression),i=o.pop(),s=this,a=function(e){if(void 0===e[i])return e[i]=r()||{},!0;var n=t();return n&&(e[i]=n),!1};if(!(o.length>0))return a(s);s.sniff(o,(function(){for(var e=0,t=o;e<t.length;e++){var r=t[e];s[r]=s[r]?s[r]:{},s=s[r]}return a(s)}),(function(e){return a(e)}))},Object.prototype.is_empty=function(){for(var e in this)if(this.hasOwnProperty(e))return!1;return!0},Object.prototype.is_Object=function(){return this===Object(this)},Object.prototype.has_Function=function(e){return"function"==typeof this[e]}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Separator={Expression:"."}}]))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(3),o=r(2),i=r(1),s=r(0),a=r(4),c=r(5),l="RI";class u extends(i.Parent().with(n.M_State,o.M_Namespace)){constructor(e){super(),this.set_GlobalNamespace(e).initialize_State({MinTrailDepth:1,MaxTrailDepth:100,Recursion:!1})}get_EntryPoint(){return this.get_State().get_Var("EntryPoint")}set_ExpressionTrail(e){const t=[l,e];return this.set_Resolution(new s.Resolution(t)),this}set_ExpressionStack(e){const t=[l,s.Resolution.produce_ExpressionTrail_FromStack(e)];return this.set_Resolution(new s.Resolution(t)),this}set_ResolutionInstruction(e){return this.set_Resolution(new s.Resolution(e)),this}set_Resolution(e){return this.set_Passage(e),this}set_Passage(e){return this.get_State().set_Var("EntryPoint",e),this}static disable_Passage(e){return a.C_Resolver.DISABLED_PHRASE+JSON.stringify(e)}static enable_Passage(e){const t=a.C_Resolver.DISABLED_PHRASE;if(this.is_DisabledPassage(e))return JSON.parse(e.slice(t.length));throw new Error(a.C_Resolver.E_NonStringType+"\n"+JSON.stringify(e))}static is_DisabledPassage(e){const t=a.C_Resolver.DISABLED_PHRASE;return"string"==typeof e&&e.slice(0,t.length)===t}set_Sources(e){return this.get_State().set_Var("Sources",e),this}get_Sources(){return this.get_State().get_Var("Sources")}set_MaxResolutionDepth(e){return this.get_State().set_Var("MaxTrailDepth",e),this}get_MaxResolutionDepth(){return this.get_State().get_Var("MaxTrailDepth")}set_MinResolutionDepth(e){if(e<1)throw new Error(a.C_Resolver.E_MinTrailDepthLimit);return this.get_State().set_Var("MinTrailDepth",e),this}get_MinResolutionDepth(){return this.get_State().get_Var("MinTrailDepth")}check_ResolutionDepth(e){const t=this.get_MaxResolutionDepth(),r=this.get_MinResolutionDepth();let n=[];if(r>t&&n.push(a.C_Resolver.E_DepthInconsistent),s.Resolution.produce_ResolutionDepth(e)>=t&&n.push(a.C_Resolver.E_TooDeep),s.Resolution.produce_ResolutionDepth(e)<r&&n.push(a.C_Resolver.E_TooShallow),0!==n.length)throw new Error(n.join("\n")+JSON.stringify(e))}set_Recursion(e){return this.get_State().set_Var("Recursion",e),this}get_Recursion(){return this.get_State().get_Var("Recursion")}produce_Resolute(){const e=this.get_EntryPoint(),t=this.build_Items(e);return this.remove_State(),t}build_Items(e){switch(u.check_ItemType(e)){case c.e_typeDefinition.ResolutionInstruction:e=new s.Resolution(e);case c.e_typeDefinition.Resolution:return this.build_Resolution(e);case c.e_typeDefinition.Array:return this.build_Array(e);case c.e_typeDefinition.Object:return this.build_Object(e);default:return e}}build_Array(e){return e.map(e=>this.build_Items(e))}build_Object(e){let t={};return"Object"!==e.constructor.name?t=e:Object.entries(e).forEach(([e,r])=>{switch(u.check_ItemType(r)){case c.e_typeDefinition.ResolutionInstruction:const n=new s.Resolution(r);t[e]=this.build_Resolution(n);break;case c.e_typeDefinition.Array:t[e]=this.build_Array(r);break;case c.e_typeDefinition.Object:t[e]=this.build_Object(r);break;default:t[e]=r}}),t}build_Resolution(e){this.check_ResolutionDepth(e);let t=this.get_Sources();const r=this.retrieve_ResolutionRules(e),n=e.produce_ExecutionStepStack(r);return n.forEach(e=>{const r=e[1],o=e[0];if(this.check_ExpressionAvailability(t,r,n),o===c.e_expressionType.Key)t=t[r];else{const n=this.build_Arguments(e[2]);t=o===c.e_expressionType.Instantiate?new t[r](...n):t[r](...n)}}),this.build_Items(t)}check_ExpressionAvailability(e,t,r){if(void 0===e[t])throw new Error(`${a.C_Resolver.DoesNotCarry.subs(t)}\n${JSON.stringify(r)}`)}build_Arguments(e){return void 0!==e?e.map(e=>{switch(u.check_ItemType(e)){case c.e_typeDefinition.ResolutionInstruction:const t=new s.Resolution(e);return this.build_Resolution(t);case c.e_typeDefinition.Object:return this.build_Object(e);case c.e_typeDefinition.Array:return this.build_Array(e);default:return e}}):[]}static check_ItemType(e){return null===e?c.e_typeDefinition.Null:void 0===e?c.e_typeDefinition.Undefined:e instanceof s.Resolution?c.e_typeDefinition.Resolution:s.Resolution.is_ResolutionInstruction(e)?c.e_typeDefinition.ResolutionInstruction:Array.isArray(e)?c.e_typeDefinition.Array:e.is_Object()?c.e_typeDefinition.Object:c.e_typeDefinition.Other}static retrieve_ItemTypeArray(e){const t=u.check_ItemType(e[0]);return e.every(e=>t===u.check_ItemType(e))?t:c.e_typeDefinition.VariableType}retrieve_ResolutionRules(e){const t=this.get_Sources(),r=e.get_ExpressionStack()[0],n=a.C_Resolver.RulesVarName;return t.sniff([s.Resolution.extract_MethodName(r),n],()=>({}),e=>e)}}t.Resolver=u}]))},function(e,t,r){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0});class r{constructor(){this.set_Separators_FromGlobal()}set_Separators_FromGlobal(){e.hasOwnProperty("Separator")?this.set_Separators(e.Separator):this.set_Separators({Directory:"/",Expression:".",Id:"-",Dialogue:"?",Monologue:":",Namespace:"/",Extension:"."})}set_Separators(e){r._SEPARATOR=e}get_Separator(e){return r._SEPARATOR[e]}}t.SeparatorHandler=r}).call(this,r(8))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(2);t.Controller=n.Controller;var o=r(9);t.M_Controller=o.M_Controller;var i=r(10);t.M_ControllerEvents=i.M_ControllerEvents;var s=r(0);t.C_Controller=s.C_Controller,t.C_StartupTalk=s.C_StartupTalk,t.C_BootState=s.C_BootState;var a=r(1);t.e_Scope=a.e_Scope},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(7),o=r(3),i=r(4),s=r(0);class a extends i.SeparatorHandler{constructor(e){super(),this._monologue_emitter=(new n.EventEmitter).setMaxListeners(20),this._dialogue_emitter=(new n.EventEmitter).setMaxListeners(20),this._announcement_archive=[],this._dialogue_archive=[],this._controller_scope=e}request(e,t,r,n,o){const i=a.create_RandomServiceId(),s=r+this.get_Separator("Dialogue")+o,c=s+this.get_Separator("Id")+i,l={Channel:c,Sender:t,Recipient:r,Talk:n,Id:i,Time:(new Date).getTime(),Static:!1,Scope:e};return new Promise((e,t)=>{this._dialogue_emitter.once(c,r=>{r.sniff("Error",e.bind(null,r),t.bind(null,r)),this.archive_Dialogue(l,r)}),this._dialogue_emitter.emit(s,l)})}respond(e,t,r,n){const o=e+this.get_Separator("Dialogue")+r;this._dialogue_emitter.on(o,e=>{t(e).then(t=>{const r={Sender:e.Recipient,Recipient:e.Sender,Talk:e.Talk,Content:t,Time:(new Date).getTime(),Static:!1,Scope:n};this._dialogue_emitter.emit(e.Channel,r)}).catch(e=>{console.log("serve error:",e)})})}archive_Dialogue(e,t){this._dialogue_archive.push({Meta:{Elapsed:(new Date).getTime()-e.Time,State:t.hasOwnProperty("Error")?"Fail":"Success"},Request:e,Response:t})}static create_RandomServiceId(){return Math.random().toString().slice(2)}get_DialogueArchive(){return this._dialogue_archive}publicget_ServedChannels(){return this._dialogue_emitter.eventNames()}announce(e,t,r,n,i=!1){const a=o.Resolution.extract_ExpressionTrail_FromResolutionInstruction(n),c=r+this.get_Separator("Monologue")+a,l={Channel:c,Sender:t,Recipient:r,Talk:n,Time:(new Date).getTime(),Static:!1,Scope:e},u=()=>{this._monologue_emitter.emit(c,l),this.archive_Announcement(t,c,l)};i?(!0===i&&(i=s.C_Controller.GraceTime),setTimeout(u,i)):u()}get_AnnouncementArchive(){return this._announcement_archive}archive_Announcement(e,t,r=null){this._announcement_archive.push({Namespace:e,Channel:t,Content:r,Time:(new Date).getTime()})}subscribe(e,t,r,n){const i=o.Resolution.extract_ExpressionTrail_FromResolutionInstruction(r),s=t+this.get_Separator("Monologue")+i;this._monologue_emitter.on(s,n)}wait(e,t,r,n,i=(()=>!0),s=(e=>e),a=1,c=a){return new Promise((l,u)=>{const _=o=>{if(i(o))c--,l(s(o));else{const o=this.wait(e,t,r,n,i,s,a,c);l(o)}};if(c>0){const e=o.Resolution.extract_ExpressionTrail_FromResolutionInstruction(n),t=r+this.get_Separator("Monologue")+e;return this._monologue_emitter.once(t,_)}}).catch(e=>{console.error("BaseController.wait.Promise.catch:\n",e)})}wait_Some(e,t,r){return Promise.all(r.map(r=>this.wait(e,t,r.Namespace,r.Listen,r.Test,r.Call)))}}t.BaseController=a},function(e,t,r){"use strict";var n,o="object"==typeof Reflect?Reflect:null,i=o&&"function"==typeof o.apply?o.apply:function(e,t,r){return Function.prototype.apply.call(e,t,r)};n=o&&"function"==typeof o.ownKeys?o.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var s=Number.isNaN||function(e){return e!=e};function a(){a.init.call(this)}e.exports=a,a.EventEmitter=a,a.prototype._events=void 0,a.prototype._eventsCount=0,a.prototype._maxListeners=void 0;var c=10;function l(e){return void 0===e._maxListeners?a.defaultMaxListeners:e._maxListeners}function u(e,t,r,n){var o,i,s,a;if("function"!=typeof r)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof r);if(void 0===(i=e._events)?(i=e._events=Object.create(null),e._eventsCount=0):(void 0!==i.newListener&&(e.emit("newListener",t,r.listener?r.listener:r),i=e._events),s=i[t]),void 0===s)s=i[t]=r,++e._eventsCount;else if("function"==typeof s?s=i[t]=n?[r,s]:[s,r]:n?s.unshift(r):s.push(r),(o=l(e))>0&&s.length>o&&!s.warned){s.warned=!0;var c=new Error("Possible EventEmitter memory leak detected. "+s.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");c.name="MaxListenersExceededWarning",c.emitter=e,c.type=t,c.count=s.length,a=c,console&&console.warn&&console.warn(a)}return e}function _(){for(var e=[],t=0;t<arguments.length;t++)e.push(arguments[t]);this.fired||(this.target.removeListener(this.type,this.wrapFn),this.fired=!0,i(this.listener,this.target,e))}function p(e,t,r){var n={fired:!1,wrapFn:void 0,target:e,type:t,listener:r},o=_.bind(n);return o.listener=r,n.wrapFn=o,o}function f(e,t,r){var n=e._events;if(void 0===n)return[];var o=n[t];return void 0===o?[]:"function"==typeof o?r?[o.listener||o]:[o]:r?function(e){for(var t=new Array(e.length),r=0;r<t.length;++r)t[r]=e[r].listener||e[r];return t}(o):d(o,o.length)}function h(e){var t=this._events;if(void 0!==t){var r=t[e];if("function"==typeof r)return 1;if(void 0!==r)return r.length}return 0}function d(e,t){for(var r=new Array(t),n=0;n<t;++n)r[n]=e[n];return r}Object.defineProperty(a,"defaultMaxListeners",{enumerable:!0,get:function(){return c},set:function(e){if("number"!=typeof e||e<0||s(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");c=e}}),a.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},a.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||s(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},a.prototype.getMaxListeners=function(){return l(this)},a.prototype.emit=function(e){for(var t=[],r=1;r<arguments.length;r++)t.push(arguments[r]);var n="error"===e,o=this._events;if(void 0!==o)n=n&&void 0===o.error;else if(!n)return!1;if(n){var s;if(t.length>0&&(s=t[0]),s instanceof Error)throw s;var a=new Error("Unhandled error."+(s?" ("+s.message+")":""));throw a.context=s,a}var c=o[e];if(void 0===c)return!1;if("function"==typeof c)i(c,this,t);else{var l=c.length,u=d(c,l);for(r=0;r<l;++r)i(u[r],this,t)}return!0},a.prototype.addListener=function(e,t){return u(this,e,t,!1)},a.prototype.on=a.prototype.addListener,a.prototype.prependListener=function(e,t){return u(this,e,t,!0)},a.prototype.once=function(e,t){if("function"!=typeof t)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t);return this.on(e,p(this,e,t)),this},a.prototype.prependOnceListener=function(e,t){if("function"!=typeof t)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t);return this.prependListener(e,p(this,e,t)),this},a.prototype.removeListener=function(e,t){var r,n,o,i,s;if("function"!=typeof t)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t);if(void 0===(n=this._events))return this;if(void 0===(r=n[e]))return this;if(r===t||r.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete n[e],n.removeListener&&this.emit("removeListener",e,r.listener||t));else if("function"!=typeof r){for(o=-1,i=r.length-1;i>=0;i--)if(r[i]===t||r[i].listener===t){s=r[i].listener,o=i;break}if(o<0)return this;0===o?r.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(r,o),1===r.length&&(n[e]=r[0]),void 0!==n.removeListener&&this.emit("removeListener",e,s||t)}return this},a.prototype.off=a.prototype.removeListener,a.prototype.removeAllListeners=function(e){var t,r,n;if(void 0===(r=this._events))return this;if(void 0===r.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==r[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete r[e]),this;if(0===arguments.length){var o,i=Object.keys(r);for(n=0;n<i.length;++n)"removeListener"!==(o=i[n])&&this.removeAllListeners(o);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=r[e]))this.removeListener(e,t);else if(void 0!==t)for(n=t.length-1;n>=0;n--)this.removeListener(e,t[n]);return this},a.prototype.listeners=function(e){return f(this,e,!0)},a.prototype.rawListeners=function(e){return f(this,e,!1)},a.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):h.call(e,t)},a.prototype.listenerCount=h,a.prototype.eventNames=function(){return this._eventsCount>0?n(this._events):[]}},function(e,t){var r;r=function(){return this}();try{r=r||new Function("return this")()}catch(e){"object"==typeof window&&(r=window)}e.exports=r},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(2),o=r(0);t.M_Controller=class{set_Controller(){if(this._controller)throw new Error(o.C_Controller.E_AlreadyDefined);this._controller=new n.Controller(this.get_GlobalNamespace()),this.has_LocalNamespace()&&this._controller.set_LocalNamespace(this.get_LocalNamespace())}get_Controller(){if(!(this._controller instanceof n.Controller))throw new Error(o.C_Controller.E_CalledBeforeDeclaration);return this._controller}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(0),o=r(1);t.M_ControllerEvents=class{include_Subscriptions(e){return this._subscriptions||(this._subscriptions=[]),this._subscriptions.push(...e),this}include_Dependencies(e){return this._dependencies||(this._dependencies=[]),this._dependencies.push(...e),this}include_Receptions(e){return this._receptions||(this._receptions=[]),this._subscriptions||(this._subscriptions=[]),this._announcements||(this._announcements=[]),this._receptions.push(...e),e.forEach(e=>{this._subscriptions.push({Scope:e.Scope,Namespace:e.Namespace||this.get_GlobalNamespace(),Listen:e.Listen,Call:e.Call}),this._announcements.push({Scope:e.Scope,Namespace:e.Namespace,Talk:e.Talk})}),this}include_Services(e){return this._services||(this._services=[]),this._services.push(...e),this}initialize_Controller(e=!0){return this.set_Controller(),e?(this.get_Controller().wait(o.e_Scope.Global,n.C_Controller.AllServices,n.C_StartupTalk.run_Listen,void 0,()=>{this.register_Dependencies(),this.register_Subscriptions(),this.announce_ToAllServices(n.C_BootState.ListenReady)}),this.get_Controller().wait(o.e_Scope.Global,n.C_Controller.AllServices,n.C_StartupTalk.run_Talk,void 0,()=>{this.register_Announcements(),this.register_Services(),this.announce_ToAllServices(n.C_BootState.TalkReady)}),this.announce_ToAllServices(n.C_BootState.ClassReady,200)):(this.register_Dependencies(),this.register_Subscriptions(),this.register_Announcements(),this.register_Services()),this}register_Subscriptions(){this._subscriptions&&this._subscriptions.forEach(e=>{this.get_Controller().subscribe(e.Scope,e.Namespace,e.Listen,e.Call)})}register_Dependencies(){this._dependencies&&this._dependencies.length>0?this._dependencies.forEach(e=>{this.get_Controller().wait_Some(e.Scope,e.Members).then(t=>e.Call(t)).then(this.announce_ToAllServices.bind(this,n.C_BootState.DependencyReady))}):this.announce_ToAllServices(n.C_BootState.DependencyReady)}register_Announcements(){this._announcements&&this._announcements.forEach(e=>{this.get_Controller().announce(e.Scope,e.Namespace,e.Talk)})}register_Services(){this._services&&this._services.forEach(e=>{this.get_Controller().respond(e.Scope,e.Call,e.Static||!1,o.e_ServiceGroup.Standard)})}manage_ControllerSequence(e,t,r){const n=[];let o=Promise.resolve();return e.forEach((e,i)=>{n[i]=this.produce_PromiseStackMember(t,r,e),o=o.then(()=>this.produce_StepsPromise(t,r,n,e,i))}),o}produce_PromiseStackMember(e,t,r){return new Promise(n=>this.get_Controller().wait(e,t,r.Listen,e=>(r.List=r.List.filter(t=>t!==e.Sender),r.List.length<1),()=>n(r.Listen)))}produce_StepsPromise(e,t,r,o,i){o.sniff(["StartMessage"],void 0,e=>{console.log(e)}),o.sniff(["Talk"],void 0,r=>{this.get_Controller().announce(e,t,r)});const s=i.toString();return r.sniff([s],()=>{throw new Error(n.C_Controller.E_ActiveStepMemberCount.subs(s))},()=>{const e=r.slice(0,i+1);return Promise.all(e)})}announce_ToAllServices(e,t=0){this.get_Controller().announce(o.e_Scope.Global,n.C_Controller.AllServices,e,t)}announce_LibraryAdded(e){this.get_Controller().announce(o.e_Scope.Global,n.C_Controller.AllServices,[...n.C_BootState.LibraryAdded,[e]],!0)}}}]));
//# sourceMappingURL=index.js.map